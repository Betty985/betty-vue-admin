var re=Object.defineProperty;var z=Object.getOwnPropertySymbols;var ne=Object.prototype.hasOwnProperty,de=Object.prototype.propertyIsEnumerable;var j=(_,o,r)=>o in _?re(_,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):_[o]=r,A=(_,o)=>{for(var r in o||(o={}))ne.call(o,r)&&j(_,r,o[r]);if(z)for(var r of z(o))de.call(o,r)&&j(_,r,o[r]);return _};import{d as ie,z as pe,B as C,A as b,l as me,r as p,D as ce,o as m,m as L,s as V,x as e,a,w as t,G as w,c as v,F as R,n as T,q as c,H as _e}from"./vendor.df9bfe02.js";import{u as M}from"./index.48e608ee.js";const Fe={class:"user-manage"},fe={class:"query-form"},be=c("\u67E5\u8BE2"),ge=c("\u91CD\u7F6E"),Be={class:"base-table"},ve={class:"action"},Ce=c("\u65B0\u589E"),he=c("\u6279\u91CF\u5220\u9664"),Ee=c("\u7F16\u8F91"),De=c("\u5220\u9664"),Ve=c(" @qq.com "),we={class:"dialog-footer"},ye=c("\u53D6\u6D88"),ke=c("\u786E\u5B9A"),Ae=ie({setup(_){const{proxy:o}=pe(),r=C({state:1}),U=b([]),q=b([]),y=b("\u7528\u6237\u65B0\u589E"),x=b([]),h=C({pageNum:1,pageSize:10,total:void 0}),d=C({state:3}),G=function(){g()},k=s=>{o.$refs[s].resetFields()},g=async()=>{let s=A(A({},r),h);try{const{list:u,page:n}=await o.$api.getUserList(s);U.value=u,h.total=n.total}catch{}},H=C({userName:[{require:!0,message:"\u8BF7\u8F93\u5165\u7528\u6237\u540D\u79F0",trigger:"blur"}],email:[{require:!0,message:"\u8BF7\u8F93\u5165\u7528\u6237\u90AE\u7BB1",trigger:"blur"}],mobile:[{pattern:/1[3-9]\d{9}/,message:"\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u624B\u673A\u53F7\u683C\u5F0F",trigger:"blur"}],deptId:[{required:!0,message:"\u8BF7\u9009\u62E9\u90E8\u95E8",trigger:"blur"}]}),O=C([{label:"\u7528\u6237\u540D\u79F0",prop:"userName"},{label:"\u7528\u6237\u90AE\u7BB1",prop:"userEmail"},{label:"\u7528\u6237\u89D2\u8272",prop:"role",formatter(s,u,n){return{0:"\u7BA1\u7406\u5458",1:"\u666E\u901A\u7528\u6237"}[n]}},{label:"\u7528\u6237\u72B6\u6001",prop:"state",formatter(s,u,n){return{1:"\u5728\u804C",2:"\u79BB\u804C",3:"\u8BD5\u7528\u671F"}[n]}},{label:"\u6CE8\u518C\u65F6\u95F4",prop:"createTime",width:180,formatter:(s,u,n)=>M.formatDate(new Date(n))},{label:"\u6700\u540E\u767B\u5F55\u65F6\u95F4",prop:"lastLoginTime",width:180,formatter:(s,u,n)=>M.formatDate(new Date(n))}]);me(()=>{g(),Y(),Z()});let P=s=>{h.pageNum=s,g()},Q=async s=>{await o.$api.userDel({userIds:[s.userId]}),o.$message.success("\u5220\u9664\u6210\u529F"),g()};const $=b([]),J=async()=>{if($.value.length==0){o.$message.error("\u8BF7\u9009\u62E9\u8981\u5220\u9664\u7684\u7528\u6237");return}(await o.$api.userDel({userIds:[$.value]})).oModified>0?(o.$message.success("\u5220\u9664\u6210\u529F"),g()):o.$message.error("\u5220\u9664\u5931\u8D25")},K=s=>{let u=[];s.map(n=>{u.push(n.userId)}),$.value=u},B=b(!1),W=()=>{y.value="\u7528\u6237\u65B0\u589E",E.value="add",B.value=!0},E=b("add"),X=s=>{E.value="edit",B.value=!0,y.value="\u7528\u6237\u7F16\u8F91",o.$nextTick(()=>{Object.assign(d,s)})},Y=async()=>{let s=await o.$api.getDeptList();x.value=s},Z=async()=>{let s=await o.$api.getRoleAllList();q.value=s},ee=()=>{B.value=!1,k("dialogForm")},ue=()=>{o.$refs.dialogForm.validate(async s=>{if(s){let u=_e(d);u.userEmail+="@qq.com",console.log(u),await o.$api.userSubmit(u)&&(B.value=!1,o.$message.success("\u7528\u6237\u521B\u5EFA\u6210\u529F"),k("dialogForm"),g())}})};return(s,u)=>{const n=p("el-input"),i=p("el-form-item"),F=p("el-option"),I=p("el-select"),f=p("el-button"),S=p("el-form"),N=p("el-table-column"),le=p("el-table"),te=p("el-pagination"),ae=p("el-cascader"),oe=p("el-dialog"),D=ce("has");return m(),L("div",Fe,[V("div",fe,[e(S,{inline:!0,ref:"form",model:a(r)},{default:t(()=>[e(i,{label:"\u7528\u6237ID",prop:"userId"},{default:t(()=>[e(n,{modelValue:a(r).userId,"onUpdate:modelValue":u[0]||(u[0]=l=>a(r).userId=l),placeholder:"\u8BF7\u8F93\u5165\u7528\u6237ID"},null,8,["modelValue"])]),_:1}),e(i,{label:"\u7528\u6237\u540D\u79F0",prop:"userName"},{default:t(()=>[e(n,{modelValue:a(r).userName,"onUpdate:modelValue":u[1]||(u[1]=l=>a(r).userName=l),placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u540D\u79F0"},null,8,["modelValue"])]),_:1}),e(i,{label:"\u72B6\u6001",prop:"state"},{default:t(()=>[e(I,{placeholder:"\u8BF7\u9009\u62E9\u7528\u6237\u72B6\u6001",modelValue:a(r).state,"onUpdate:modelValue":u[2]||(u[2]=l=>a(r).state=l)},{default:t(()=>[e(F,{value:0,label:"\u6240\u6709"}),e(F,{value:1,label:"\u5728\u804C"}),e(F,{value:2,label:"\u79BB\u804C"}),e(F,{value:3,label:"\u8BD5\u7528\u671F"})]),_:1},8,["modelValue"])]),_:1}),e(i,null,{default:t(()=>[e(f,{type:"primary",onClick:G},{default:t(()=>[be]),_:1}),e(f,{onClick:u[3]||(u[3]=l=>k("form"))},{default:t(()=>[ge]),_:1})]),_:1})]),_:1},8,["model"])]),V("div",Be,[V("div",ve,[w((m(),v(f,{type:"primary",onClick:W},{default:t(()=>[Ce]),_:1})),[[D,"user-create"]]),w((m(),v(f,{type:"danger",onClick:J},{default:t(()=>[he]),_:1})),[[D,"user-patch-delete"]])]),e(le,{data:U.value,onSelectionChange:K},{default:t(()=>[e(N,{type:"selection",width:"55"}),(m(!0),L(R,null,T(a(O),l=>(m(),v(N,{key:l.prop,prop:l.prop,label:l.label,formatter:l.formatter,width:l.width},null,8,["prop","label","formatter","width"]))),128)),e(N,{label:"\u64CD\u4F5C",width:"150"},{default:t(l=>[w((m(),v(f,{onClick:se=>X(l.row),size:"small"},{default:t(()=>[Ee]),_:2},1032,["onClick"])),[[D,"user-eidt"]]),w((m(),v(f,{type:"danger",onClick:se=>a(Q)(l.row),size:"small"},{default:t(()=>[De]),_:2},1032,["onClick"])),[[D,"user-delete"]])]),_:1})]),_:1},8,["data"]),e(te,{class:"pagination",background:"",layout:"prev, pager, next",total:1e3,pageSize:a(h).pageSize,onCurrentChange:a(P)},null,8,["pageSize","onCurrentChange"])]),e(oe,{title:y.value,modelValue:B.value,"onUpdate:modelValue":u[11]||(u[11]=l=>B.value=l)},{footer:t(()=>[V("span",we,[e(f,{onClick:ee},{default:t(()=>[ye]),_:1}),e(f,{type:"primary",onClick:ue},{default:t(()=>[ke]),_:1})])]),default:t(()=>[e(S,{ref:"dialogForm",model:a(d),"label-width":"100px",rules:a(H)},{default:t(()=>[e(i,{label:"\u7528\u6237\u540D",prop:"userName"},{default:t(()=>[e(n,{disabled:E.value==="edit",modelValue:a(d).userName,"onUpdate:modelValue":u[4]||(u[4]=l=>a(d).userName=l),placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u540D\u79F0"},null,8,["disabled","modelValue"])]),_:1}),e(i,{label:"\u90AE\u7BB1",prop:"mobile"},{default:t(()=>[e(n,{disabled:E.value==="edit",modelValue:a(d).userEmail,"onUpdate:modelValue":u[5]||(u[5]=l=>a(d).userEmail=l),placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u90AE\u7BB1"},{append:t(()=>[Ve]),_:1},8,["disabled","modelValue"])]),_:1}),e(i,{label:"\u624B\u673A\u53F7",prop:"mobile"},{default:t(()=>[e(n,{modelValue:a(d).mobile,"onUpdate:modelValue":u[6]||(u[6]=l=>a(d).mobile=l),placeholder:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7"},null,8,["modelValue"])]),_:1}),e(i,{label:"\u5C97\u4F4D",prop:"job"},{default:t(()=>[e(n,{modelValue:a(d).job,"onUpdate:modelValue":u[7]||(u[7]=l=>a(d).job=l),placeholder:"\u8BF7\u8F93\u5165\u5C97\u4F4D"},null,8,["modelValue"])]),_:1}),e(i,{label:"\u72B6\u6001",prop:"state"},{default:t(()=>[e(I,{modelValue:a(d).state,"onUpdate:modelValue":u[8]||(u[8]=l=>a(d).state=l)},{default:t(()=>[e(F,{value:1,label:"\u5728\u804C"}),e(F,{value:2,label:"\u79BB\u804C"}),e(F,{value:3,label:"\u8BD5\u7528\u671F"})]),_:1},8,["modelValue"])]),_:1}),e(i,{label:"\u7CFB\u7EDF\u89D2\u8272",prop:"roleList"},{default:t(()=>[e(I,{modelValue:a(d).roleList,"onUpdate:modelValue":u[9]||(u[9]=l=>a(d).roleList=l),placeholder:"\u8BF7\u9009\u62E9\u5BF9\u5E94\u7528\u6237\u7CFB\u7EDF\u89D2\u8272",mutiple:"",style:{width:"100%"}},{default:t(()=>[(m(!0),L(R,null,T(q.value,l=>(m(),v(F,{key:l._id,label:l.roleName,value:l._id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(i,{label:"\u90E8\u95E8",prop:"deptId"},{default:t(()=>[e(ae,{modelValue:a(d).deptId,"onUpdate:modelValue":u[10]||(u[10]=l=>a(d).deptId=l),placeholder:"\u8BF7\u9009\u62E9\u5BF9\u5E94\u90E8\u95E8",options:x.value,props:{checkStrictly:!0,value:"_id",label:"deptName"},clearable:"",style:{width:"100%"}},null,8,["modelValue","options"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])])}}});export{Ae as default};
