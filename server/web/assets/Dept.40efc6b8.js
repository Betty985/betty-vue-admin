var Y=Object.defineProperty,Z=Object.defineProperties;var ee=Object.getOwnPropertyDescriptors;var q=Object.getOwnPropertySymbols;var le=Object.prototype.hasOwnProperty,ue=Object.prototype.propertyIsEnumerable;var U=(d,o,r)=>o in d?Y(d,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):d[o]=r,x=(d,o)=>{for(var r in o||(o={}))le.call(o,r)&&U(d,r,o[r]);if(q)for(var r of q(o))ue.call(o,r)&&U(d,r,o[r]);return d},L=(d,o)=>Z(d,ee(o));import{d as te,B,A as D,z as ae,l as oe,r as i,D as se,o as p,m as A,s as y,x as t,a,w as l,G as h,c as b,J as re,F as z,n as T,q as f,M as ne}from"./vendor.df9bfe02.js";const de={class:"dept-manage"},ie={class:"query-form"},pe=f("\u67E5\u8BE2"),me=f("\u91CD\u7F6E"),ce={class:"base-table"},_e={class:"action"},Ee=f("\u521B\u5EFA"),fe=f("\u7F16\u8F91"),Fe=f("\u5220\u9664 "),be={class:"dialog-footer"},ge=f("\u53D6\u6D88"),De=f("\u786E\u5B9A"),ye=te({setup(d){let o=B({deptName:""}),r=D([{label:"\u90E8\u95E8\u540D\u79F0",prop:"deptName"},{label:"\u8D1F\u8D23\u4EBA",prop:"userName"},{label:"\u66F4\u65B0\u65F6\u95F4",prop:"updateTime"},{label:"\u521B\u5EFA\u65F6\u95F4",prop:"createTime"}]),V=D([]);B({pageNum:1,pageSize:10});let F=D("create"),_=D(!1),n=B({parentId:[null]}),N=D([]),M=B({parentId:[{required:!0,message:"\u8BF7\u9009\u62E9\u4E0A\u7EA7\u90E8\u95E8",trigger:blur}],deptName:[{required:!0,message:"\u8BF7\u8F93\u5165\u90E8\u95E8\u540D\u79F0",trigger:blur}],user:[{required:!0,message:"\u8BF7\u9009\u62E9\u8D1F\u8D23\u4EBA",trigger:blur}]}),{proxy:m}=ae();oe(()=>{C(),O()});async function C(){let s=await m.$api.getDeptList(o);V.value=s}async function O(){N.value=await m.$api.getAllUserList()}function S(s){const[u,g,c]=s.split("/");Object.assign(n,{userId:u,userName:g,userEmail:c})}function k(s){m.$refs[s].resetFields()}function j(){F.value="create",_.value=!0}function R(s){F.value="edit",_.value=!0,m.$nextTick(()=>{Object.assign(n,s,{user:`${s.userId}/${s.userName}/${s.userEmail}`})})}async function G(s){F.value="delete",await m.$api.operateDept({_id:s,action:F})}function $(){_.value=!1,k("dialogForm")}function J(){m.$refs.dialogForm.validate(async s=>{if(s){let u=L(x({},n),{action:F});delete u.user,await m.$api.operateDept(u),m.$message.success("\u64CD\u4F5C\u6210\u529F"),$(),C()}})}return(s,u)=>{const g=i("el-input"),c=i("el-form-item"),E=i("el-button"),w=i("el-form"),I=i("el-table-column"),P=i("el-table"),H=i("el-cascader"),K=i("el-option"),Q=i("el-select"),W=i("el-dialog"),v=se("has");return p(),A("div",de,[y("div",ie,[t(w,{ref_key:"queryForm",ref:o,model:a(o),inline:!0},{default:l(()=>[t(c,{label:"\u90E8\u95E8\u540D\u79F0",prop:"deptName"},{default:l(()=>[t(g,{placeholder:"\u8BF7\u8F93\u5165\u90E8\u95E8\u540D\u79F0",modelValue:a(o).deptName,"onUpdate:modelValue":u[0]||(u[0]=e=>a(o).deptName=e)},null,8,["modelValue"])]),_:1}),t(c,null,{default:l(()=>[h((p(),b(E,{onClick:C,type:"primary"},{default:l(()=>[pe]),_:1})),[[v,"dept-query"]]),t(E,{onClick:u[1]||(u[1]=e=>k("queryForm"))},{default:l(()=>[me]),_:1})]),_:1})]),_:1},8,["model"])]),y("div",ce,[y("div",_e,[h((p(),b(E,{type:"primary",onClick:j},{default:l(()=>[Ee]),_:1})),[[v,"dept-create"]])]),t(P,{data:a(V),"row-key":"_id","tree-props":{children:"children"},stripe:""},{default:l(()=>[(p(!0),A(z,null,T(a(r),e=>(p(),b(I,ne({key:e.prop},e),null,16))),128)),t(I,{label:"\u64CD\u4F5C"},{default:l(e=>[h((p(),b(E,{size:"small",type:"primary",onClick:X=>R(e.row)},{default:l(()=>[fe]),_:2},1032,["onClick"])),[[v,"dept-edit"]]),h((p(),b(E,{size:"small",type:"danger",onClick:X=>G(e.row._id)},{default:l(()=>[Fe]),_:2},1032,["onClick"])),[[v,"dept-delete"]])]),_:1})]),_:1},8,["data"])]),t(W,{title:a(F)==="create"?"\u521B\u5EFA\u90E8\u95E8":"\u7F16\u8F91\u90E8\u95E8",modelValue:a(_),"onUpdate:modelValue":u[6]||(u[6]=e=>re(_)?_.value=e:_=e)},{footer:l(()=>[y("span",be,[t(E,{onClick:$},{default:l(()=>[ge]),_:1}),t(E,{onClick:J,type:"primary"},{default:l(()=>[De]),_:1})])]),default:l(()=>[t(w,{ref:"dialogForm",model:a(n),rules:a(M),"label-width":"120px"},{default:l(()=>[t(c,{lable:"\u4E0A\u7EA7\u90E8\u95E8",prop:"parentId"},{default:l(()=>[t(H,{placeholder:"\u8BF7\u9009\u62E9\u4E0A\u7EA7\u90E8\u95E8",modelValue:a(n).parentId,"onUpdate:modelValue":u[2]||(u[2]=e=>a(n).parentId=e),props:{checkSrictly:!0,value:"_id",label:"deptName"},clearable:"",options:a(V),"show-all-levels":!0},null,8,["modelValue","options"])]),_:1}),t(c,{label:"\u90E8\u95E8\u540D\u79F0",prop:"deptName"},{default:l(()=>[t(g,{placeholder:"\u8BF7\u8F93\u5165\u90E8\u95E8\u540D\u79F0",modelValue:a(n).deptName,"onUpdate:modelValue":u[3]||(u[3]=e=>a(n).deptName=e)},null,8,["modelValue"])]),_:1}),t(c,{label:"\u8D1F\u8D23\u4EBA"},{default:l(()=>[t(Q,{placeholder:"\u8BF7\u9009\u62E9\u8D1F\u8D23\u4EBA",modelValue:a(n).user,"onUpdate:modelValue":u[4]||(u[4]=e=>a(n).user=e),onChange:S},{default:l(()=>[(p(!0),A(z,null,T(a(N),e=>(p(),b(K,{key:e.userId,label:e.userName,value:`${e.userId}/${e.userName}/${e.userEmail}`},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(c,{label:"\u8D1F\u8D23\u4EBA\u90AE\u7BB1",prop:"userEmail"},{default:l(()=>[t(g,{modelValue:a(n).userEmail,"onUpdate:modelValue":u[5]||(u[5]=e=>a(n).userEmail=e),disabled:""},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])])}}});export{ye as default};
